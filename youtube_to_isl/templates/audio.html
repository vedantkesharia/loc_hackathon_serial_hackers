<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>AUDIO TO ISL</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <link rel='stylesheet' type='text/css' media='screen' href="{{url_for('static',filename='./style.css')}}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- <link rel="stylesheet" href="http://vhg.cmp.uea.ac.uk/tech/jas/vhg2021/cwa/cwasa.css" /> -->
    <!-- <script type="text/javascript" src="http://vhg.cmp.uea.ac.uk/tech/jas/vhg2021/cwa/allcsa.js"></script> -->
 
    <meta http-equiv="Access-Control-Allow-Methods" content="GET">
    <link rel="stylesheet"
    href="{{url_for('static',filename='css/cwasa.css')}}">
    <script type="text/javascript"
    src="{{url_for('static',filename='js/allcsa.js')}}"></script>
    <!-- player css and js files -->
    <!-- <link rel="stylesheet" href="css/cwasa.css" /> -->
    <!-- <script type="text/javascript" src="js/allcsa.js"></script> -->
 
    <script language="javascript">
        // Initial configuration
        var initCfg = {
            "avsbsl" : ["luna", "siggi", "anna", "marc", "francoise"],
            "avSettings" : { "avList": "avsbsl", "initAv": "marc" }
        };
 
        // global variable to store the sigmal list
        var sigmlList = null;
 
        // global variable to tell if avatar is ready or not
        var tuavatarLoaded = false;
 
 
        var playerAvailableToPlay = true;
 
        function runSpeechRecognition() {
            // get output div reference
            var output = document.getElementById("output");
            // get action element reference
            var action = document.getElementById("action");
            // new speech recognition object
            var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition;
            var recognition = new SpeechRecognition();
       
            // This runs when the speech recognition service starts
            recognition.onstart = function() {
                action.innerHTML = "<small>listening, please speak...</small>";
            };
           
            recognition.onspeechend = function() {
                action.innerHTML = "<small>stopped listening, hope you are done...</small>";
                recognition.stop();
            }
         
            // This runs when the speech recognition service returns result
            recognition.onresult = function(event) {
                var transcript = event.results[0][0].transcript;
                var confidence = event.results[0][0].confidence;
                output.innerHTML = "<b>Text:</b> " + transcript;
                output.classList.remove("hide");
                $.ajax({
                    url:'/',
                    type:'POST',
                    data:{text:transcript},
                    success: function(res)
                    {
                      convert_json_to_arr(res);
                      play_each_word();
                      display_isl_text(res);
                    },
                    error: function(xhr)
                    {
                      console.log(xhr);
                    }
                });
            };
         
             // start recognition
             recognition.start();
        }
    </script>
<!-- <script language="javascript" src="js/animationPlayer.js"></script> -->
<style type="text/css">
    body {
        overflow-y: hidden !important;
        overflow-x: hidden !important;
    }
</style>
<link rel="stylesheet" href="css/audio.css">
 
</head>
<body onload="CWASA.init(initCfg);">
    <script language="javascript">
 
// console.log("hello");
 
function playText(stext) {
    CWASA.playSiGMLText(stext);
}
 
// sets url for sigml
function setSiGMLURL(sigmlURL) {
    console.log("hello");
    var loc = window.location.href;
    var locDir = loc.substring(0, loc.lastIndexOf('/'));
    // console.log("SiGML: "+sigmlURL);
    // console.log("Location Dir: "+locDir);
    sigmlURL = locDir + "/" + sigmlURL;
    // console.log("here");
    console.log("URL "+sigmlURL);
    document.getElementById("URLText").value = sigmlURL;
    return sigmlURL;
}
// starts the player animation
function startPlayer(sigmlURL) {
    sigmlURL = setSiGMLURL(sigmlURL);
    console.log("URL "+sigmlURL);
    // Equivalent to click on Sign button
    CWASA.getLogger("myLog","warn");
    CWASA.playSiGMLURL(sigmlURL);
    CWASA.getLogger("myLog","warn");
}
</script>
<!-- navbar starts -->
<!-- navbar starts -->
<div class="nav-container">
    <div class="logo">
        <a href="#"><img src="./images/logo.png" alt="Logo"></a>
    </div>
    <div class="other--links">
        <ul>
            <li><a class="others" href="#">HOME</a></li>
            <li><a class="others" href="http://127.0.0.1:8001/query">FOR VISUALLY IMPAIRED</a></li>
            <li><div class="dropdown">
                <button class="dropbtn">FOR DYSLEXIA
                    <img src="./images/down.png" id="down" alt="">
                </button>
                <div class="dropdown-content">
                  <button><a href="http://127.0.0.1:8001/whack">WHACK A MOLE</a></button>
                  <button><a href="http://127.0.0.1:8001/memory">MEMORY GAME</a></button>
        
                </div>
              </div></li>
            <li><div class="dropdown">
                <button class="dropbtn">SIGN FOR DEAF
                    <img src="./images/down.png" id="down" alt="">
                </button>
                <div class="dropdown-content">
                  <button><a href="{{ url_for('youtube') }}">YouTube to ISL</a></button>
                  <button><a href="{{ url_for('audio_to_text') }}">Audio To ISL</a></button>
                  <button><a href="{{ url_for('index') }}">Text to ISL</a></button>
                  <button><a href="{{ url_for('learn') }}">Learn ISL</a></button>
        
                </div>
              </div></li>
        </ul>
    </div>
    <!-- <div class="donation"><a href="#">Donate Now</a></div> -->
</div>
<!-- navbar ends -->
<!-- navbar ends -->
<!-- navbar ends -->
<div class="audioContainer">
    <div class="mainContainer">
        <div class="englishInput">
            <form method="POST" id= 'form'>
                    <button id="submit"><i class="fas fa-microphone"></i></button> &nbsp; <span id="action"></span>
                </form>
            <!-- <button class="btn-primary bttnPlaySiGMLURL av0">Submit</button> -->
            <!-- <input type="button" value="Sign" class="bttnPlaySiGMLURL av0" /> -->
        </div>
        <div id="output" class="hide"></div>
        <div class="curr_playing">
            Current Word :- <p class="curr_word_playing"></p>
        </div>
        <div class="islOutput">
            ISL text: <p id ="isl_text"></p>
 
        </div>
    </div>
<div class="main">
    <div class="container">
        <!-- animation player frame -->
        <div class="player card" style="border: none; height:auto; width: 95%;">
            <a id="player"></a>
            <div class="anim">
                <div class="avatarChoice">
                    <span class="avatarText">Choose Your Avatar:</span>
                    <span class="CWASAAvMenu av0"></span>
                </div>
                <div style="box-sizing: border-box; width: 90%; height: 100%; text-align: center;" >
                    <table align="center" style="width:100%; height:100%; border: 2px solid #fef9f7; border-radius: 10px; border-collapse: separate; background-color: #f9d9cc;" >
                    <tr align="center">
                   
                    <!--================================================================-->
                    <!-- CWA signing avatar panel 0 -->
                    <!--================================================================-->
                    <!-- Replaced by an avatar panel -->
                    <!--================================================================-->
                    <td width="100%" height="90%" >
                        <div class="CWASAAvatar av0" align="center" ></div>
                        <span class="CWASASpeed av0"></span>
                    </td>
                    <!--================================================================-->
                   
                    </tr><tr>
                   
                    <td align="center" >
                   
                    <!--<span class="CWASAAvMenu av0" ></span>
                    <input type="button" value="Sign" class="bttnPlaySiGMLURL av0" />
                    <input type="button" value="Stop" class="bttnStop av0" />
                    <span class="CWASASpeed av0" ></span>
                    <br/>
                   
                    <span style="font-size: 90%;" >
                    Sign/Frame:
                    <input class="txtSF av0" value="0/0" type="text">-->
                    <!--Gloss:
                    <input class="txtGloss av0" value="[none]" type="text">-->
                    <!--</span>
                    <span class="spanInfo av0">
                        Status:
                        <input type="text" class="statusExtra av0">
                        </span>-->
                    <!--  CachedSiGML URL  -->
                    <input type="text" id="URLText" class="txtSiGMLURL av0 undisplayed" value="" />
                   
                    <script language="javascript">
                    // Set default sign
                    // console.log("here");
                    setSiGMLURL("SignFiles/B.sigml");
                   
                    </script>
                   
                    </td>
                    </tr>
                   
                    </table>
                   
                    </div>
                   
            </div>
           
        </div>
        <!-- input for text -->
       
        <!--<div class="test_word_list">
            Available Words:-
            <ul class="test_list">
               
            </ul>
        </div> -->
       
    </div>
</div>
</div>
    <script type="text/javascript" src="{{ url_for('static', filename='js/audio.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <!-- <script type="text/javascript" src="{{ url_for('static', filename='js/player.js') }}"></script> -->
 
</body>
</html>